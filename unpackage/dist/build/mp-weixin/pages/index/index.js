"use strict";const t=require("../../common/vendor.js"),e="https://ehre.icehomura.com/api/",s={components:{uniList:()=>"../../components/uni-list/uni-list.js",uniListItem:()=>"../../components/uni-list-item/uni-list-item.js",Weather:()=>"../../components/weather/weather.js",musicPlayer:()=>"../../components/music/music.js"},data:()=>({postList:[],background:[],page:1,pageFlag:!0,status:"加载中..."}),onLoad(){this.getList(this.page),this.getMain(),this.getIndexPic()},onPullDownRefresh(){console.log("触发了下拉刷新"),setTimeout((()=>{this.getList(),t.index.stopPullDownRefresh()}),2e3)},onReachBottom(){console.log("触发了上拉加载"),this.pageFlag?(this.page++,this.getList(this.page)):console.log("没有更多啦！")},methods:{async getList(s){let n={page:s,pageSize:10};t.index.request({url:e+"posts",method:"get",dataType:"json",data:n,success:t=>{this.postList=this.postList.concat(t.data.data),t.data.data.length<10&&(this.pageFlag=!1,this.status="已经到底啦！")}})},cardOnClick(e,s,n){t.index.navigateTo({url:"/pages/post/post?title="+e+"&text="+s+"&cid="+n})},async getMain(){t.index.request({url:e+"post?cid=170",method:"get",dataType:"json",success:t=>{var e=t.data.data.text.split(","),s=parseInt(e[0]),n=e[1];let o=parseInt(e[2]),a=e[3];this.putInfo(s,n,o,a)}})},getPostText(t){let e=t.split(";"),s="";return s=null==e[1]?e[0]?e[0]:"暂时没有简介了啦(●'◡'●)":e[1],s},getIndexPic(){t.index.request({url:e+"getIndexPic",method:"get",dataType:"json",success:t=>{let e=t.data.data;this.background=e.split(";")}})},putInfo(e,s,n,o){switch(e){case 1:t.index.showModal({title:"Tips",content:s,showCancel:!1,confirmText:"OK！"});break;case 2:plus.runtime.version.split(".").join("")<n&&t.index.showModal({title:"有更新啦！",content:s,showCancel:"取消",confirmText:"前往更新",success:function(t){t.confirm?plus.runtime.openURL(o):t.cancel&&console.log("用户点击取消")}})}}}};if(!Array){(t.resolveComponent("uni-card")+t.resolveComponent("Weather")+t.resolveComponent("musicPlayer")+t.resolveComponent("uni-list"))()}Math||((()=>"../../components/uni-card/uni-card.js")+(()=>"../../components/uni-list/uni-list.js"))();const n=t._export_sfc(s,[["render",function(e,s,n,o,a,i){return{a:t.f(a.background,((e,s,n)=>({a:"ac5190ac-0-"+n,b:t.p({cover:e})}))),b:t.f(a.postList,((e,s,n)=>({a:t.t(i.getPostText(e.text)),b:t.o((t=>i.cardOnClick(e.title,e.text,e.cid)),s),c:"ac5190ac-4-"+n+",ac5190ac-3-"+n,d:t.p({title:e.title,"sub-title":`${e.year}-${e.month}-${e.day}`,extra:e.category,thumbnail:"/static/love.svg",margin:"5px 20px"}),e:s,f:"ac5190ac-3-"+n}))),c:t.p({border:!1}),d:t.t(a.status)}}]]);wx.createPage(n);
